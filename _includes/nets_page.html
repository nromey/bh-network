{%- comment -%}
Usage examples:

{% include nets_page.html
   nets=site.data.nets.nets
   title="Blind Hams Nets"
   category="bhn"
   section_id="nets-bhn"           # optional; default: "nets-section"
   nco_anchor="nco-schedule"       # optional; default: "nco-schedule"
%}

Notes:
- Expects /assets/js/net-view.js to handle the radio toggle.
  Tip: in your JS, consider KEY = "netView:" + (location.pathname || "/") for per-page preferences.
{%- endcomment -%}

{%- assign title = include.title | default: "Nets" -%}
{%- assign cat = include.category | default: "bhn" -%}
{%- assign section_id = include.section_id | default: "nets-section" -%}
{%- assign nco_anchor = include.nco_anchor | default: "nco-schedule" -%}
{%- assign filtered = include.nets | where: "category", cat -%}

<section class="nets-section" data-view="table" id="{{ section_id }}">
  <header class="nets-header">
    <h2>{{ title }}</h2>

    <!-- Display toggle -->
    <fieldset class="view-toggle" aria-label="Display format">
      <legend class="sr-only">Display format</legend>
      <label>
        <input type="radio" name="net-view-{{ section_id }}" value="table" checked>
        Table
      </label>
      <label>
        <input type="radio" name="net-view-{{ section_id }}" value="headings">
        Headings
      </label>
    </fieldset>
  </header>

  <!-- TABLE VIEW (default; no-JS friendly) -->
  <div class="view view-table" aria-live="polite">
    <table>
      <thead>
        <tr>
          <th scope="col">Net</th>
          <th scope="col">When (ET)</th>
          <th scope="col">Duration</th>
          <th scope="col">Location</th>
        </tr>
      </thead>
      <tbody>
      {% for n in filtered %}
        <tr>
          <td>
            <strong>{{ n.name }}</strong><br>
            <small>{{ n.description }}</small>
            {%- if n.id == "bh-digital" -%}
              <br><a href="#{{ nco_anchor }}">See NCO schedule ↓</a>
            {%- endif -%}
          </td>
          <td>{{ n.rrule }} at {{ n.start_local }}</td>
          <td>{{ n.duration_min }} min</td>
          <td>{% include net_location.html net=n %}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- HEADINGS VIEW (hidden until chosen) -->
  <div class="view view-headings" hidden aria-live="polite">
    {% for n in filtered %}
      <article class="net-block">
        <h3>{{ n.name }}</h3>
        <p class="net-when"><strong>When:</strong> {{ n.rrule }} at {{ n.start_local }} ET ({{ n.duration_min }} min)</p>
        {%- if n.id == "bh-digital" -%}
          <p><a href="#{{ nco_anchor }}">See NCO schedule ↓</a></p>
        {%- endif -%}
        <p class="net-where"><strong>Where:</strong> {% include net_location.html net=n %}</p>
        <p class="net-desc">{{ n.description }}</p>
      </article>
      {% unless forloop.last %}<hr>{% endunless %}
    {% endfor %}
  </div>
</section>

<!-- Tiny script (loaded once per page) -->
<script defer src="/assets/js/net-view.js"></script>

