{%- comment -%}
Renders a human-friendly "where to connect" line showing ALL available options.
Order/logic:
1) If `location` (markdown) exists → render it and stop.
2) Else, collect frequency[/mode], Talkgroup, AllStar, EchoLink (all that exist).
3) If none of the above but `website` exists → render a "More info" link.
4) Else → default to "Blind Hams Bridge".
{%- endcomment -%}

{%- assign net = include.net | default: nil -%}
{%- if net == nil -%}
  <span class="net-location">Blind Hams Bridge</span>
{%- elsif net.location -%}
  {%- assign loc = net.location | markdownify | replace: "<p>", "" | replace: "</p>", "" | strip -%}
  <span class="net-location">{{ loc }}</span>
{%- else -%}
  {%- assign pieces = "" | split: "" -%}

  {%- if net.frequency -%}
    {%- assign freq = net.frequency -%}
    {%- if net.mode -%}{%- assign freq = freq | append: " " | append: net.mode -%}{%- endif -%}
    {%- assign pieces = pieces | push: freq -%}
  {%- endif -%}

  {%- if net.talkgroup -%}
    {%- assign pieces = pieces | push: "Talkgroup " | push: net.talkgroup -%}
  {%- endif -%}

  {%- if net.allstar -%}
    {%- assign pieces = pieces | push: "AllStar " | push: net.allstar -%}
  {%- endif -%}

  {%- if net.echolink -%}
    {%- assign pieces = pieces | push: "EchoLink " | push: net.echolink -%}
  {%- endif -%}

  {%- comment -%}
  Additional digital voice and app links commonly used:
  - Peanut (dvmega app)
  - D-STAR (accept both `dstar` and `DStar` keys)
  - YSF (Yaesu System Fusion)
  - WIRES-X (accept `wiresx` or `wires_x`)
  - P25
  - NXDN
  {%- endcomment -%}

  {%- assign peanut_val = net.peanut -%}
  {%- if peanut_val -%}
    {%- assign pieces = pieces | push: "Peanut " | push: peanut_val -%}
  {%- endif -%}

  {%- assign dstar_val = net.dstar | default: net.DStar -%}
  {%- if dstar_val -%}
    {%- assign pieces = pieces | push: "D-STAR " | push: dstar_val -%}
  {%- endif -%}

  {%- assign ysf_val = net.ysf -%}
  {%- if ysf_val -%}
    {%- assign pieces = pieces | push: "YSF " | push: ysf_val -%}
  {%- endif -%}

  {%- assign wiresx_val = net.wiresx | default: net.wires_x -%}
  {%- if wiresx_val -%}
    {%- assign pieces = pieces | push: "WIRES-X " | push: wiresx_val -%}
  {%- endif -%}

  {%- assign p25_val = net.p25 -%}
  {%- if p25_val -%}
    {%- assign pieces = pieces | push: "P25 " | push: p25_val -%}
  {%- endif -%}

  {%- assign nxdn_val = net.nxdn -%}
  {%- if nxdn_val -%}
    {%- assign pieces = pieces | push: "NXDN " | push: nxdn_val -%}
  {%- endif -%}

  {%- assign joined = pieces | join: ", " | strip -%}

  {%- if joined == "" and net.website -%}
    {%- assign joined = "[More info](" | append: net.website | append: ")" 
       | markdownify | replace: "<p>", "" | replace: "</p>", "" | strip -%}
  {%- endif -%}

  {%- if joined == "" -%}
    {%- assign joined = "Blind Hams Bridge" -%}
  {%- endif -%}

  <span class="net-location">{{ joined }}</span>
{%- endif -%}
